# 多套提示词系统 - 方案设计

## 问题分析

### 当前痛点

| 问题 | 影响 | 严重程度 |
|------|------|----------|
| 提示词硬编码 | 无法根据场景调整 AI 行为 | 🔴 高 |
| 不支持自定义提示词 | 用户无法定制化使用体验 | 🔴 高 |
| 单一提示词适配所有场景 | 学术/日常/专业场景效果不佳 | 🟡 中 |
| 提示词迭代困难 | 修改需要改代码、重新部署 | 🟡 中 |
| 无法对比不同提示词效果 | 无法优化 AI 输出质量 | 🟢 低 |

### 用户需求场景

```
┌─────────────────────────────────────────────────────────────┐
│ 用户使用场景分析                                              │
├─────────────────────────────────────────────────────────────┤
│ 场景1: 日常笔记整理                                          │
│   → 需求: 简单分类，不需要过度智能化                           │
│   → 提示词: 简洁版、快速整理                                   │
├─────────────────────────────────────────────────────────────┤
│ 场景2: 学术论文大纲                                          │
│   → 需求: 规范结构（背景、方法、结果、结论）                   │
│   → 提示词: 学术风格模板                                       │
├─────────────────────────────────────────────────────────────┤
│ 场景3: 项目规划/任务分解                                      │
│   → 需求: 产出可执行的任务清单                                 │
│   → 提示词: 项目管理风格模板                                   │
├─────────────────────────────────────────────────────────────┤
│ 场景4: 会议纪要整理                                          │
│   → 需求: 提取要点、分发言人记录                               │
│   → 提示词: 会议纪要模板                                       │
├─────────────────────────────────────────────────────────────┤
│ 场景5: 自定义场景                                            │
│   → 需求: 用户根据自己需求定制提示词                          │
│   → 提示词: 完全自定义                                        │
└─────────────────────────────────────────────────────────────┘
```

## 解决方案

### 核心思路

```
┌─────────────────────────────────────────────────────────────┐
│                    提示词管理系统架构                         │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│   ┌─────────────┐    ┌─────────────┐    ┌─────────────┐    │
│   │  内置模板   │    │  自定义模板 │    │  场景模板   │    │
│   │  (Default)  │    │  (User)     │    │  (Domain)   │    │
│   └──────┬──────┘    └──────┬──────┘    └──────┬──────┘    │
│          │                  │                  │           │
│          └──────────────────┼──────────────────┘           │
│                             │                              │
│                    ┌────────▼────────┐                     │
│                    │   PromptManager │                     │
│                    │   (统一管理)     │                     │
│                    └────────┬────────┘                     │
│                             │                              │
│          ┌──────────────────┼──────────────────┐           │
│          ▼                  ▼                  ▼           │
│   ┌─────────────┐    ┌─────────────┐    ┌─────────────┐   │
│   │  前端UI     │    │   API层     │    │  本地存储   │   │
│   │  (切换)     │    │  (注入)     │    │  (持久化)   │   │
│   └─────────────┘    └─────────────┘    └─────────────┘   │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 价值主张

| 维度 | 提升点 |
|------|--------|
| **灵活性** | 内置多套模板 + 用户自定义 |
| **易用性** | 一键切换，无需技术背景 |
| **可维护性** | 提示词与代码分离，热更新 |
| **可扩展性** | 轻松添加新模板/场景 |
| **可对比性** | 不同模板效果可量化对比 |

## 预期收益

### 业务价值

- ✅ 用户可以根据场景选择最合适的 AI 行为
- ✅ 降低用户学习成本，提供开箱即用的优秀模板
- ✅ 自定义功能满足高级用户定制化需求
- ✅ 提示词迭代不再依赖发版

### 技术价值

- ✅ AI 模块架构更清晰，职责分离
- ✅ 便于测试不同提示词效果
- ✅ 为未来更多 AI 功能奠定基础
- ✅ 支持提示词版本管理和回滚

## 风险评估

### 潜在风险

| 风险 | 概率 | 影响 | 缓解措施 |
|------|------|------|----------|
| 自定义提示词导致 AI 输出不稳定 | 中 | 中 | 提供验证机制、默认兜底 |
| 提示词格式错误导致 API 报错 | 中 | 低 | 格式校验、UI 引导 |
| 过多模板造成用户选择困难 | 低 | 低 | 智能推荐、默认选中 |
| 本地存储数据丢失 | 低 | 低 | 导出备份功能 |

### 兜底方案

- 任何情况下使用 fallback 到默认提示词
- 提示词保存前进行 JSON 格式验证
- 敏感操作（清空自定义）需要二次确认
